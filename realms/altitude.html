<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>fly away...</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
		<script src="../js/wetlands.js"></script>
    <style>
      body {
        margin: 0; padding: 0;
        background-color: rgb(39, 39, 39);
        max-height: 100vh;
      }
      #geoff {
        position: absolute;
        transform: translateX(-50%) translateY(-50%);
        top: 50vh; left: 50vw;
        user-select: none;
      }
      #blurb {
        position: fixed;
        bottom: 0;
        background: black;
        width: 100%;
        height: 100px;
        border: 2px solid gray;
      }
      p {
        color: gray;
        user-select: none;
      }
    </style>
  </head>
  <body>
    <img id="geoff" src="../gifs/geoff.gif">
    <div id="blurb"><p>&emsp;> <span id="tx"></span></p></div>
    <div id="lightning"></div>
  </body>
  <script>
    let dia = [
      'Goodness, you have come a long way!',
      'Your progress is impressive.',
      'O@ï¿½F[ï¿½ï¿½ï¿½ï¿½.ï¿½ï¿½ï¿½Uï¿½Yï¿½p',
      'You know, it\'s pretty rare that our paths would cross like this.',
      'Do yâ¨â¨â¨Ì¹Ì Í…â¨Í Ì©Ì¬Ì£ÍŽÌâ¨Ì¬Ìºâ¨ÍÍ•Ì²Ì°ÌžÌ³Í™â¨Ì›Ì–Ì¯â¨ÍÍ“Ì¦Ì Í‰â¨Ò‰Ì»Ì³Ì»â¨â¨â¨â¨_â¨iiâ¨â¨â¨artments?',
      'I remember the pets I had as a child...',
      '(â•¬â–”çš¿â–”)â•¯', 'Pets are so dirty!',
      'ï¿½bï¿½,:cï¿½4ï¿½Gdï¿½O@ï¿½F[ï¿½ï¿½ï¿½ï¿½.ï¿½ï¿½ï¿½Uï¿½Yï¿½pï¿½Yï¿½Uï¿½sï¿½ï¿½9o?ï¿½ï¿½Ä£!ï¿½mï¿½ï¿½ï¿½ï¿½8Aï¿½'
    ];

    let run = false, log = 0, tx = $('#tx'), printer;

    let talk = new Audio('../audio/talking1.mp3');

    $(window).on('click', () => {

        if (log >= dia.length) window.open('../index.html', '_self');

        if (!run) {
            run = true;
            talk.play();
            tx.text('');
            let txt = dia[log++], i = 0;
            printer = setInterval(() => {
                tx.append(txt[i++]);
                if (i === txt.length) {
                    clearInterval(printer);
                    talk.pause();
                    if (chance(0.5)) talk.currentTime = 0;
                    run = false;
                }
            }, 30);

        } else {
            run = false;
            talk.pause();
            clearInterval(printer);
            tx.text(dia[log-1]);
        }
    });

    document.getElementById("tx").click();

    setInterval(() => {
      if (chance(0.05)) {
        $('body').css('opacity', `${Math.random()}`);
        setTimeout(() => {$('body').css('opacity', '1');}, 20);
      }
    }, 30);
  </script>
</html>